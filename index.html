<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>äºŒåå±Šå››ä¸­å…¨ä¼šçŸ¥è¯†ç­”é¢˜ - æˆç»©å…±äº«ç‰ˆ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Microsoft YaHei', sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1a2a6c, #2a4a6c, #3a6a8c);
        color: #333;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        width: 100%;
        max-width: 1000px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      header {
        background: linear-gradient(to right, #1a2a6c, #2a4a6c);
        color: white;
        padding: 25px;
        text-align: center;
        position: relative;
      }

      header h1 {
        font-size: 2.2rem;
        margin-bottom: 10px;
      }

      .subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .flag {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 2rem;
      }

      .content {
        padding: 30px;
      }

      .screen {
        display: none;
      }

      .screen.active {
        display: block;
      }

      .welcome-screen {
        text-align: center;
      }

      .welcome-screen h2 {
        color: #1a2a6c;
        margin-bottom: 20px;
        font-size: 1.8rem;
      }

      .welcome-screen p {
        margin-bottom: 15px;
        line-height: 1.6;
        color: #555;
        text-align: left;
      }

      .btn {
        background: linear-gradient(to right, #1a2a6c, #2a4a6c);
        color: white;
        border: none;
        padding: 12px 25px;
        font-size: 1rem;
        border-radius: 8px;
        cursor: pointer;
        margin: 8px;
        transition: all 0.3s ease;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .btn.secondary {
        background: #6c757d;
      }

      .btn.success {
        background: #28a745;
      }

      /* è¡¨å•æ ·å¼ */
      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s ease;
      }

      .form-group input:focus {
        border-color: #1a2a6c;
        outline: none;
      }

      .question-number {
        color: #1a2a6c;
        font-weight: 600;
        margin-bottom: 10px;
      }

      .question {
        font-size: 1.4rem;
        margin-bottom: 25px;
        line-height: 1.5;
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        border-left: 5px solid #1a2a6c;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 30px;
      }

      .option {
        padding: 15px 20px;
        background: #f5f7fa;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        display: flex;
        align-items: center;
      }

      .option:hover {
        background: #e9ecef;
        transform: translateX(5px);
      }

      .option.selected {
        background: #d6e4f7;
        border-color: #1a2a6c;
      }

      .option-label {
        width: 30px;
        height: 30px;
        background: #1a2a6c;
        color: white;
        border-radius: 50%;
        text-align: center;
        line-height: 30px;
        margin-right: 15px;
        font-weight: bold;
      }

      .navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .progress {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .progress-bar {
        width: 200px;
        height: 10px;
        background: #e9ecef;
        border-radius: 5px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(to right, #1a2a6c, #2a4a6c);
        width: 0%;
        transition: width 0.5s ease;
      }

      .result-screen {
        text-align: center;
      }

      .score {
        font-size: 4rem;
        font-weight: bold;
        color: #1a2a6c;
        margin: 20px 0;
      }

      .stats {
        display: flex;
        justify-content: space-around;
        margin: 30px 0;
      }

      .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: bold;
        color: #1a2a6c;
      }

      .stat-label {
        color: #666;
        margin-top: 5px;
      }

      .feedback {
        margin: 20px 0;
        padding: 15px;
        border-radius: 10px;
        background: #f8f9fa;
      }

      /* æˆç»©æ’è¡Œæ¦œæ ·å¼ */
      .scoreboard {
        margin: 20px 0;
        max-height: 400px;
        overflow-y: auto;
      }

      .scoreboard table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      .scoreboard th,
      .scoreboard td {
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid #e9ecef;
      }

      .scoreboard th {
        background: #1a2a6c;
        color: white;
        position: sticky;
        top: 0;
      }

      .scoreboard tr:nth-child(even) {
        background: #f8f9fa;
      }

      .scoreboard tr:hover {
        background: #e9ecef;
      }

      .rank-1 {
        background: #fff3cd !important;
      }
      .rank-2 {
        background: #e9ecef !important;
      }
      .rank-3 {
        background: #f8d7da !important;
      }

      .loading {
        text-align: center;
        padding: 20px;
        color: #666;
      }

      @media (max-width: 768px) {
        .container {
          margin: 10px;
          border-radius: 10px;
        }
        header h1 {
          font-size: 1.8rem;
        }
        .content {
          padding: 20px;
        }
        .question {
          font-size: 1.2rem;
        }
        .stats {
          flex-direction: column;
          gap: 20px;
        }
        .navigation {
          flex-direction: column;
          gap: 15px;
        }
        .btn {
          width: 100%;
        }
        .scoreboard {
          font-size: 0.9rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>äºŒåå±Šå››ä¸­å…¨ä¼šçŸ¥è¯†ç­”é¢˜</h1>
        <div class="subtitle">
          æ·±å…¥å­¦ä¹ é¢†ä¼šå…¨ä¼šç²¾ç¥ æŠŠæ¡"åäº”äº”"è§„åˆ’æ–¹å‘ - æˆç»©å…±äº«ç‰ˆ
        </div>
        <div class="flag">ğŸ‡¨ğŸ‡³</div>
      </header>

      <div class="content">
        <!-- æ¬¢è¿ç•Œé¢ -->
        <div id="welcomeScreen" class="screen active">
          <div class="welcome-screen">
            <h2>æ¬¢è¿å‚åŠ äºŒåå±Šå››ä¸­å…¨ä¼šçŸ¥è¯†æµ‹è¯•</h2>
            <p>
              æœ¬æ¬¡æµ‹è¯•åŒ…å«10é“å…³äºäºŒåå±Šå››ä¸­å…¨ä¼šçš„é‡è¦çŸ¥è¯†ç‚¹ï¼Œç­”é¢˜åæˆç»©å°†å®æ—¶å…±äº«åˆ°æ’è¡Œæ¦œã€‚
            </p>
            <div class="btn-group">
              <button
                class="btn primary"
                onclick="showScreen('userInfoScreen')"
              >
                å¼€å§‹ç­”é¢˜
              </button>
              <button class="btn success" onclick="loadScoreboard()">
                æŸ¥çœ‹æˆç»©æ’è¡Œæ¦œ
              </button>
            </div>
          </div>
        </div>

        <!-- ç”¨æˆ·ä¿¡æ¯ç•Œé¢ -->
        <div id="userInfoScreen" class="screen">
          <div class="welcome-content">
            <h2>è¯·å¡«å†™ä¸ªäººä¿¡æ¯</h2>
            <form id="userInfoForm">
              <div class="form-group">
                <label for="userName">å§“åï¼š</label>
                <input
                  type="text"
                  id="userName"
                  required
                  placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å"
                />
              </div>
              <div class="form-group">
                <label for="userDepartment">å•ä½/éƒ¨é—¨ï¼š</label>
                <input
                  type="text"
                  id="userDepartment"
                  required
                  placeholder="è¯·è¾“å…¥æ‚¨çš„å•ä½æˆ–éƒ¨é—¨"
                />
              </div>
              <button type="submit" class="btn primary">å¼€å§‹ç­”é¢˜</button>
              <button
                type="button"
                class="btn secondary"
                onclick="showScreen('welcomeScreen')"
              >
                è¿”å›
              </button>
            </form>
          </div>
        </div>

        <!-- ç­”é¢˜ç•Œé¢ -->
        <div id="quizScreen" class="screen">
          <div class="question-number" id="questionNumber">é¢˜ç›® 1/10</div>
          <div class="question" id="question">é—®é¢˜åŠ è½½ä¸­...</div>

          <div class="options" id="options"></div>

          <div class="navigation">
            <button class="btn secondary" id="prevBtn">ä¸Šä¸€é¢˜</button>
            <div class="progress">
              <span id="progressText">0/10</span>
              <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
            </div>
            <button class="btn primary" id="nextBtn">ä¸‹ä¸€é¢˜</button>
          </div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div id="resultScreen" class="screen">
          <div class="result-content">
            <div class="result-header">
              <h2>ç­”é¢˜å®Œæˆ!</h2>
              <div class="score" id="score">0/10</div>
            </div>

            <div class="stats">
              <div class="stat-item">
                <div class="stat-value" id="correctCount">0</div>
                <div class="stat-label">æ­£ç¡®</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="incorrectCount">0</div>
                <div class="stat-label">é”™è¯¯</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="percentage">0%</div>
                <div class="stat-label">æ­£ç¡®ç‡</div>
              </div>
            </div>

            <div class="feedback" id="feedback"></div>

            <div class="btn-group">
              <button class="btn primary" id="restartBtn">é‡æ–°å¼€å§‹</button>
              <button class="btn success" onclick="loadScoreboard()">
                æŸ¥çœ‹æˆç»©æ’è¡Œæ¦œ
              </button>
            </div>
          </div>
        </div>

        <!-- æˆç»©æ’è¡Œæ¦œç•Œé¢ -->
        <div id="scoreboardScreen" class="screen">
          <div class="welcome-content">
            <h2>æˆç»©æ’è¡Œæ¦œ</h2>
            <div id="scoreboard" class="scoreboard">
              <div class="loading">æ­£åœ¨åŠ è½½æˆç»©æ•°æ®...</div>
            </div>
            <button class="btn primary" onclick="showScreen('welcomeScreen')">
              è¿”å›é¦–é¡µ
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // é…ç½®ä¿¡æ¯ - éœ€è¦æ‚¨ä¿®æ”¹çš„éƒ¨åˆ†
      const CONFIG = {
        GITHUB_TOKEN: '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', // æ›¿æ¢ä¸ºæ‚¨çš„GitHubä»¤ç‰Œ
        REPO_OWNER: 'XQ0731', // æ›¿æ¢ä¸ºæ‚¨çš„GitHubç”¨æˆ·å
        REPO_NAME: 'quiz-app', // æ›¿æ¢ä¸ºæ‚¨çš„ä»“åº“å
        LABEL: 'æˆç»©è®°å½•', // Issuesæ ‡ç­¾
      };

      // ç”¨æˆ·ä¿¡æ¯
      let userInfo = {
        name: '',
        department: '',
        timestamp: '',
      };

      // é¢˜ç›®æ•°æ®
      const questions = [
        {
          question: 'äºŒåå±Šå››ä¸­å…¨ä¼šäºä½•æ—¶ä¸¾è¡Œï¼Ÿ',
          options: [
            '2025å¹´10æœˆ20æ—¥è‡³23æ—¥',
            '2025å¹´10æœˆ21æ—¥è‡³24æ—¥',
            '2025å¹´10æœˆ19æ—¥è‡³22æ—¥',
            '2025å¹´10æœˆ22æ—¥è‡³25æ—¥',
          ],
          correct: 0,
          explanation: 'äºŒåå±Šå››ä¸­å…¨ä¼šäº2025å¹´10æœˆ20æ—¥è‡³23æ—¥åœ¨åŒ—äº¬ä¸¾è¡Œã€‚',
        },
        {
          question: 'å…¨ä¼šå®¡è®®é€šè¿‡äº†ä¸‹åˆ—å“ªé¡¹é‡è¦æ–‡ä»¶ï¼Ÿ',
          options: [
            'ã€Šä¸­å…±ä¸­å¤®å…³äºåˆ¶å®šå›½æ°‘ç»æµå’Œç¤¾ä¼šå‘å±•ç¬¬åå››ä¸ªäº”å¹´è§„åˆ’çš„å»ºè®®ã€‹',
            'ã€Šä¸­å…±ä¸­å¤®å…³äºåˆ¶å®šå›½æ°‘ç»æµå’Œç¤¾ä¼šå‘å±•ç¬¬åäº”ä¸ªäº”å¹´è§„åˆ’çš„å»ºè®®ã€‹',
            'ã€Šä¸­å…±ä¸­å¤®å…³äºå…¨é¢æ¨è¿›ä¹¡æ‘æŒ¯å…´çš„å»ºè®®ã€‹',
            'ã€Šä¸­å…±ä¸­å¤®å…³äºæ·±åŒ–æ–‡åŒ–ä½“åˆ¶æ”¹é©çš„å»ºè®®ã€‹',
          ],
          correct: 1,
          explanation:
            'å…¨ä¼šå®¡è®®é€šè¿‡äº†ã€Šä¸­å…±ä¸­å¤®å…³äºåˆ¶å®šå›½æ°‘ç»æµå’Œç¤¾ä¼šå‘å±•ç¬¬åäº”ä¸ªäº”å¹´è§„åˆ’çš„å»ºè®®ã€‹ã€‚',
        },
        {
          question: 'â€œåäº”äº”â€æ—¶æœŸåœ¨ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–è¿›ç¨‹ä¸­å…·æœ‰æ€æ ·çš„åœ°ä½ï¼Ÿ',
          options: [
            'åˆæ­¥æ¢ç´¢é˜¶æ®µ',
            'å…¨é¢æ”¶å®˜é˜¶æ®µ',
            'æ‰¿å‰å¯åçš„å…³é”®æ—¶æœŸ',
            'å…¨é¢å®ç°é˜¶æ®µ',
          ],
          correct: 2,
          explanation:
            'â€œåäº”äº”â€æ—¶æœŸåœ¨ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–è¿›ç¨‹ä¸­å…·æœ‰æ‰¿å‰å¯åçš„å…³é”®åœ°ä½ã€‚',
        },
        {
          question: 'ä¸‹åˆ—å“ªé¡¹ä¸å±äºâ€œåäº”äº”â€æ—¶æœŸç»æµç¤¾ä¼šå‘å±•å¿…é¡»éµå¾ªçš„åŸåˆ™ï¼Ÿ',
          options: [
            'åšæŒå…šçš„å…¨é¢é¢†å¯¼',
            'åšæŒé«˜é€Ÿå¢é•¿',
            'åšæŒäººæ°‘è‡³ä¸Š',
            'åšæŒé«˜è´¨é‡å‘å±•',
          ],
          correct: 1,
          explanation: 'â€œåäº”äº”â€æ—¶æœŸå¼ºè°ƒé«˜è´¨é‡å‘å±•ï¼Œè€Œéç®€å•è¿½æ±‚é«˜é€Ÿå¢é•¿ã€‚',
        },
        {
          question: 'å…¨ä¼šæå‡ºè¦åŠ å¿«å»ºè®¾å“ªäº›â€œå¼ºå›½â€ï¼Ÿ',
          options: [
            'åˆ¶é€ å¼ºå›½ã€è´¨é‡å¼ºå›½ã€èˆªå¤©å¼ºå›½ã€äº¤é€šå¼ºå›½ã€ç½‘ç»œå¼ºå›½',
            'å·¥ä¸šå¼ºå›½ã€å†œä¸šå¼ºå›½ã€ç§‘æŠ€å¼ºå›½ã€æ–‡åŒ–å¼ºå›½ã€å†›äº‹å¼ºå›½',
            'æµ·æ´‹å¼ºå›½ã€èƒ½æºå¼ºå›½ã€é‡‘èå¼ºå›½ã€æ•™è‚²å¼ºå›½ã€ä½“è‚²å¼ºå›½',
            'ä¿¡æ¯å¼ºå›½ã€ç”Ÿæ€å¼ºå›½ã€æ³•æ²»å¼ºå›½ã€å¥åº·å¼ºå›½ã€å¹³å®‰å¼ºå›½',
          ],
          correct: 0,
          explanation:
            'å…¨ä¼šæå‡ºåŠ å¿«å»ºè®¾åˆ¶é€ å¼ºå›½ã€è´¨é‡å¼ºå›½ã€èˆªå¤©å¼ºå›½ã€äº¤é€šå¼ºå›½ã€ç½‘ç»œå¼ºå›½ã€‚',
        },
        {
          question: 'å…¨ä¼šå¼ºè°ƒè¦åŠ å¿«æ„å»ºä»€ä¹ˆæ ·çš„ç»æµä½“åˆ¶ï¼Ÿ',
          options: [
            'è®¡åˆ’ç»æµä½“åˆ¶',
            'è‡ªç”±å¸‚åœºç»æµä½“åˆ¶',
            'é«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶',
            'æ··åˆæ‰€æœ‰åˆ¶ç»æµä½“åˆ¶',
          ],
          correct: 2,
          explanation: 'å…¨ä¼šå¼ºè°ƒè¦åŠ å¿«æ„å»ºé«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶ã€‚',
        },
        {
          question: 'å…¨ä¼šæå‡ºè¦æ‰å®æ¨è¿›å“ªé¡¹é‡å¤§æˆ˜ç•¥ä»¥ä¿ƒè¿›å†œæ‘å‘å±•ï¼Ÿ',
          options: [
            'åŸå¸‚ä¼˜å…ˆå‘å±•',
            'ä¹¡æ‘å…¨é¢æŒ¯å…´',
            'å†œä¸šå•ä¸€åŒ–å‘å±•',
            'å†œæ‘äººå£å¤–è¿',
          ],
          correct: 1,
          explanation: 'å…¨ä¼šæå‡ºæ‰å®æ¨è¿›ä¹¡æ‘å…¨é¢æŒ¯å…´æˆ˜ç•¥ã€‚',
        },
        {
          question: 'ä»¥ä¸‹å“ªé¡¹æ˜¯â€œåäº”äº”â€æ—¶æœŸç»æµç¤¾ä¼šå‘å±•çš„é‡è¦ç›®æ ‡ä¹‹ä¸€ï¼Ÿ',
          options: [
            'å®ç°é«˜é€Ÿå¢é•¿',
            'ç§‘æŠ€è‡ªç«‹è‡ªå¼ºæ°´å¹³å¤§å¹…æé«˜',
            'å…¨é¢å–æ¶ˆå¯¹å¤–å¼€æ”¾',
            'å‡å°‘ç¤¾ä¼šä¿éšœæŠ•å…¥',
          ],
          correct: 1,
          explanation: 'â€œåäº”äº”â€æ—¶æœŸçš„é‡è¦ç›®æ ‡ä¹‹ä¸€æ˜¯ç§‘æŠ€è‡ªç«‹è‡ªå¼ºæ°´å¹³å¤§å¹…æé«˜ã€‚',
        },
        {
          question: 'å…¨ä¼šå¼ºè°ƒè¦ç‰¢å›ºæ ‘ç«‹å’Œè·µè¡Œå“ªä¸€ç†å¿µæ¥æ¨åŠ¨ç»¿è‰²è½¬å‹ï¼Ÿ',
          options: [
            'å‘å±•æ˜¯ç¡¬é“ç†',
            'ç»¿æ°´é’å±±å°±æ˜¯é‡‘å±±é“¶å±±',
            'å…ˆæ±¡æŸ“åæ²»ç†',
            'èµ„æºæ— é™åˆ©ç”¨',
          ],
          correct: 1,
          explanation: 'å…¨ä¼šå¼ºè°ƒç‰¢å›ºæ ‘ç«‹å’Œè·µè¡Œç»¿æ°´é’å±±å°±æ˜¯é‡‘å±±é“¶å±±çš„ç†å¿µã€‚',
        },
        {
          question: 'å…¨ä¼šå·å¬å…¨å…šå…¨å†›å…¨å›½å„æ—äººæ°‘å›¢ç»“åœ¨è°å‘¨å›´ï¼Ÿ',
          options: [
            'å…šä¸­å¤®',
            'ä¸­å¤®å†›å§”',
            'ä»¥ä¹ è¿‘å¹³åŒå¿—ä¸ºæ ¸å¿ƒçš„å…šä¸­å¤®',
            'å…¨å›½äººæ°‘ä»£è¡¨å¤§ä¼š',
          ],
          correct: 2,
          explanation:
            'å…¨ä¼šå·å¬å…¨å…šå…¨å†›å…¨å›½å„æ—äººæ°‘å›¢ç»“åœ¨ä»¥ä¹ è¿‘å¹³åŒå¿—ä¸ºæ ¸å¿ƒçš„å…šä¸­å¤®å‘¨å›´ã€‚',
        },
      ];

      let currentQuestion = 0;
      let userAnswers = new Array(questions.length).fill(null);

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function () {
        // ç”¨æˆ·ä¿¡æ¯è¡¨å•æäº¤
        document
          .getElementById('userInfoForm')
          .addEventListener('submit', function (e) {
            e.preventDefault();
            startQuizWithUserInfo();
          });

        // ç­”é¢˜æŒ‰é’®äº‹ä»¶
        document
          .getElementById('startBtn')
          ?.addEventListener('click', () => showScreen('userInfoScreen'));
        document
          .getElementById('prevBtn')
          .addEventListener('click', prevQuestion);
        document
          .getElementById('nextBtn')
          .addEventListener('click', nextQuestion);
        document
          .getElementById('restartBtn')
          .addEventListener('click', restartQuiz);
      });

      // æ˜¾ç¤ºæŒ‡å®šå±å¹•
      function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach((screen) => {
          screen.classList.remove('active');
        });
        document.getElementById(screenId).classList.add('active');
      }

      // å¼€å§‹ç­”é¢˜ï¼ˆå¸¦ç”¨æˆ·ä¿¡æ¯ï¼‰
      function startQuizWithUserInfo() {
        const name = document.getElementById('userName').value;
        const department = document.getElementById('userDepartment').value;

        if (!name || !department) {
          alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
          return;
        }

        userInfo = {
          name: name,
          department: department,
          timestamp: new Date().toLocaleString('zh-CN'),
        };

        showScreen('quizScreen');
        showQuestion();
      }

      // æ˜¾ç¤ºé¢˜ç›®
      function showQuestion() {
        const question = questions[currentQuestion];
        document.getElementById('questionNumber').textContent = `é¢˜ç›® ${
          currentQuestion + 1
        }/${questions.length}`;
        document.getElementById('question').textContent = question.question;

        const optionsElement = document.getElementById('options');
        optionsElement.innerHTML = '';

        question.options.forEach((option, index) => {
          const optionElement = document.createElement('div');
          optionElement.className = 'option';
          if (userAnswers[currentQuestion] === index) {
            optionElement.classList.add('selected');
          }

          const optionLabel = document.createElement('div');
          optionLabel.className = 'option-label';
          optionLabel.textContent = String.fromCharCode(65 + index);

          const optionText = document.createElement('div');
          optionText.textContent = option;

          optionElement.appendChild(optionLabel);
          optionElement.appendChild(optionText);
          optionElement.addEventListener('click', () => selectOption(index));
          optionsElement.appendChild(optionElement);
        });

        updateProgress();
        document.getElementById('prevBtn').disabled = currentQuestion === 0;
        document.getElementById('nextBtn').textContent =
          currentQuestion === questions.length - 1 ? 'æäº¤ç­”æ¡ˆ' : 'ä¸‹ä¸€é¢˜';
      }

      // é€‰æ‹©é€‰é¡¹
      function selectOption(index) {
        userAnswers[currentQuestion] = index;
        showQuestion();
      }

      // æ›´æ–°è¿›åº¦
      function updateProgress() {
        const answeredCount = userAnswers.filter(
          (answer) => answer !== null
        ).length;
        const progress = (answeredCount / questions.length) * 100;
        document.getElementById(
          'progressText'
        ).textContent = `${answeredCount}/${questions.length}`;
        document.getElementById('progressFill').style.width = `${progress}%`;
      }

      // ä¸Šä¸€é¢˜
      function prevQuestion() {
        if (currentQuestion > 0) {
          currentQuestion--;
          showQuestion();
        }
      }

      // ä¸‹ä¸€é¢˜
      function nextQuestion() {
        if (currentQuestion < questions.length - 1) {
          currentQuestion++;
          showQuestion();
        } else {
          showResults();
        }
      }

      // æ˜¾ç¤ºç»“æœ
      function showResults() {
        showScreen('resultScreen');

        let correctCount = 0;
        userAnswers.forEach((answer, index) => {
          if (answer === questions[index].correct) {
            correctCount++;
          }
        });

        const totalQuestions = questions.length;
        const score = correctCount;
        const percentage = Math.round((correctCount / totalQuestions) * 100);

        // æ›´æ–°æ˜¾ç¤º
        document.getElementById(
          'score'
        ).textContent = `${score}/${totalQuestions}`;
        document.getElementById('correctCount').textContent = correctCount;
        document.getElementById('incorrectCount').textContent =
          totalQuestions - correctCount;
        document.getElementById('percentage').textContent = `${percentage}%`;

        // æäº¤æˆç»©åˆ°GitHub
        submitScoreToGitHub(score, correctCount, totalQuestions, percentage);

        // æ˜¾ç¤ºåé¦ˆ
        let feedback = '';
        if (percentage >= 90)
          feedback = 'å¤ªæ£’äº†ï¼æ‚¨å¯¹äºŒåå±Šå››ä¸­å…¨ä¼šç²¾ç¥æœ‰æ·±å…¥çš„ç†è§£å’ŒæŒæ¡ï¼';
        else if (percentage >= 70)
          feedback = 'åšå¾—ä¸é”™ï¼æ‚¨å¯¹å…¨ä¼šä¸»è¦å†…å®¹æœ‰è¾ƒå¥½çš„ç†è§£ã€‚';
        else if (percentage >= 50)
          feedback = 'è¿˜å¯ä»¥ï¼Œä½†è¿˜éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ å…¨ä¼šç²¾ç¥ã€‚';
        else feedback = 'éœ€è¦åŠ å¼ºå­¦ä¹ ï¼Œå»ºè®®ä»”ç»†ç ”è¯»å…¨ä¼šå…¬æŠ¥å’Œç›¸å…³æ–‡ä»¶ã€‚';

        document.getElementById('feedback').textContent = feedback;
      }

      // æäº¤æˆç»©åˆ°GitHub Issues
      async function submitScoreToGitHub(
        score,
        correctCount,
        totalQuestions,
        percentage
      ) {
        const scoreData = {
          timestamp: userInfo.timestamp,
          name: userInfo.name,
          department: userInfo.department,
          score: `${score}/${totalQuestions}`,
          correctCount: correctCount,
          totalQuestions: totalQuestions,
          percentage: percentage,
        };

        const issueTitle = `æˆç»©è®°å½• - ${scoreData.name} - ${scoreData.percentage}%`;
        const issueBody = `
### ç­”é¢˜äººä¿¡æ¯
- **å§“å**: ${scoreData.name}
- **å•ä½**: ${scoreData.department}
- **å¾—åˆ†**: ${scoreData.score}
- **æ­£ç¡®ç‡**: ${scoreData.percentage}%
- **ç­”é¢˜æ—¶é—´**: ${scoreData.timestamp}

### è¯¦ç»†æˆç»©
- æ­£ç¡®é¢˜æ•°: ${scoreData.correctCount}
- æ€»é¢˜æ•°: ${scoreData.totalQuestions}
- å¾—åˆ†: ${scoreData.score}

*æ­¤è®°å½•ç”±ç­”é¢˜ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ*
            `;

        try {
          const response = await fetch(
            `https://api.github.com/repos/${CONFIG.REPO_OWNER}/${CONFIG.REPO_NAME}/issues`,
            {
              method: 'POST',
              headers: {
                Authorization: `token ${CONFIG.GITHUB_TOKEN}`,
                Accept: 'application/vnd.github.v3+json',
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                title: issueTitle,
                body: issueBody,
                labels: [CONFIG.LABEL],
              }),
            }
          );

          if (response.ok) {
            console.log('æˆç»©å·²æˆåŠŸæäº¤åˆ°GitHub');
          } else {
            throw new Error('æäº¤å¤±è´¥');
          }
        } catch (error) {
          console.error('æäº¤åˆ°GitHubå¤±è´¥:', error);
          // å¤‡ç”¨æ–¹æ¡ˆï¼šä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
          saveToLocalStorage(scoreData);
        }
      }

      // ä»GitHub Issuesè·å–æˆç»©æ•°æ®
      async function loadScoreboard() {
        showScreen('scoreboardScreen');
        const scoreboardElement = document.getElementById('scoreboard');
        scoreboardElement.innerHTML =
          '<div class="loading">æ­£åœ¨ä»GitHubåŠ è½½æˆç»©æ•°æ®...</div>';

        try {
          const response = await fetch(
            `https://api.github.com/repos/${CONFIG.REPO_OWNER}/${CONFIG.REPO_NAME}/issues?labels=${CONFIG.LABEL}&state=all&per_page=100`
          );

          if (!response.ok) {
            throw new Error('æ— æ³•åŠ è½½æˆç»©æ•°æ®');
          }

          const issues = await response.json();
          const scores = parseScoresFromIssues(issues);

          displayScoreboard(scores);
        } catch (error) {
          console.error('åŠ è½½æˆç»©æ•°æ®å¤±è´¥:', error);
          // å¤‡ç”¨æ–¹æ¡ˆï¼šä»æœ¬åœ°å­˜å‚¨åŠ è½½
          loadFromLocalStorage();
        }
      }

      // ä»Issuesè§£ææˆç»©æ•°æ®
      function parseScoresFromIssues(issues) {
        const scores = [];

        issues.forEach((issue) => {
          const body = issue.body;
          const nameMatch = body.match(/\*\*å§“å\*\*: (.+)/);
          const departmentMatch = body.match(/\*\*å•ä½\*\*: (.+)/);
          const scoreMatch = body.match(/\*\*å¾—åˆ†\*\*: (.+)/);
          const percentageMatch = body.match(/\*\*æ­£ç¡®ç‡\*\*: (\d+)%/);
          const timestampMatch = body.match(/\*\*ç­”é¢˜æ—¶é—´\*\*: (.+)/);

          if (nameMatch && percentageMatch) {
            scores.push({
              name: nameMatch[1],
              department: departmentMatch ? departmentMatch[1] : 'æœªçŸ¥',
              score: scoreMatch ? scoreMatch[1] : '0/10',
              percentage: parseInt(percentageMatch[1]),
              timestamp: timestampMatch ? timestampMatch[1] : 'æœªçŸ¥æ—¶é—´',
              issueUrl: issue.html_url,
            });
          }
        });

        // æŒ‰æˆç»©æ’åº
        return scores.sort((a, b) => b.percentage - a.percentage);
      }

      // æ˜¾ç¤ºæˆç»©æ’è¡Œæ¦œ
      function displayScoreboard(scores) {
        const scoreboardElement = document.getElementById('scoreboard');

        if (scores.length === 0) {
          scoreboardElement.innerHTML =
            '<div class="loading">æš‚æ— æˆç»©è®°å½•</div>';
          return;
        }

        let html = `
                <table>
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>å§“å</th>
                            <th>å•ä½</th>
                            <th>å¾—åˆ†</th>
                            <th>æ­£ç¡®ç‡</th>
                            <th>ç­”é¢˜æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

        scores.forEach((score, index) => {
          const rankClass = index < 3 ? `rank-${index + 1}` : '';
          html += `
                    <tr class="${rankClass}">
                        <td>${index + 1}</td>
                        <td>${score.name}</td>
                        <td>${score.department}</td>
                        <td>${score.score}</td>
                        <td>${score.percentage}%</td>
                        <td>${score.timestamp}</td>
                    </tr>
                `;
        });

        html += `
                    </tbody>
                </table>
                <p style="text-align: center; margin-top: 15px; color: #666;">
                    å…± ${scores.length} æ¡æˆç»©è®°å½• | æ•°æ®å®æ—¶æ›´æ–°
                </p>
            `;

        scoreboardElement.innerHTML = html;
      }

      // æœ¬åœ°å­˜å‚¨å¤‡ç”¨æ–¹æ¡ˆ
      function saveToLocalStorage(data) {
        let allScores = JSON.parse(localStorage.getItem('quizScores') || '[]');
        allScores.push(data);
        localStorage.setItem('quizScores', JSON.stringify(allScores));
      }

      function loadFromLocalStorage() {
        const allScores = JSON.parse(
          localStorage.getItem('quizScores') || '[]'
        );
        displayScoreboard(
          allScores.sort((a, b) => b.percentage - a.percentage)
        );
      }

      // é‡æ–°å¼€å§‹
      function restartQuiz() {
        currentQuestion = 0;
        userAnswers = new Array(questions.length).fill(null);
        showScreen('welcomeScreen');
      }
    </script>
  </body>
</html>
